<%- include('header.ejs') %>
    
    <main class='signin clearfix'>
        <seccion>
            <h2>User Accounts</h2>
            <table>
                <thead>
                    <tr>
                        <th colspan="6">User Management table</th>
                    </tr>
                </thead>
                    <tr>
                        <th>User</th>
                        <th>User Type</th>
                        <th>Password Status</th>
                        <th>Password Reset</th>
                        <th>Revoked Status</th>
                        <th>Revoke</th>
                    </tr>
        
                
                <% if (typeof userList !== 'undefined'){ %> 
                    <% userList.forEach( (user)=> { %>
                    <tr>        
                        <td><%= user.email %></td>
                        <td><%= user.accountType %></td>
                        <td> <%= user.verifying ? "Pending" : "Completed" %></td>
                        <td>
                            <form class="login-form" action="/auth/reset" method="POST">
                                <input type="hidden" name="email" value="<%= user.email %>">
                                <input type="submit" value='Reset'>
                            </form>
                        </td>
                        <td><%= user.revoked ? "Yes" : "No" %></td>
                        <td>
                            <form class="login-form" action="/auth/revoke" method="POST">
                                <input type="hidden" name="email" value="<%= user.email %>">
                                <input type="submit" value='<%= user.revoked ? "Reinstate" : "Revoke" %>'>
                            </form>
                        </td>
                    </tr>
                    <% }) %>
                <% } %>
                
            </table>
        </seccion>
        <section>
            <h2>Create User Account</h2>
            <p>To create an user account you need to fill out the form below, then complete the verification process.</p>
            <form class="login-form" action="/auth/user" method="POST">
                <% if (typeof user !== 'undefined'){ %> 
                    <% if (user.accountType === "Owner"){ %> 
                <select name="accountType">
                    <option selected value="Case Worker">Case Worker</option>
                    <option value="App Manager">App Manager</option>
                    <option value="Owner">Owner</option>
                </select>
                    <% }else{ %>
                <input type="hidden" name="accountType" value="Case Worker">
                    <% } %>
                <% } %>
                <input type="text" name='email' placeholder="email">
                <input type="submit" value='Submit'>
            </form>
        </section>
    </main>
</body>
</html>